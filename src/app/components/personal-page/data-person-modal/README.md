# DataPersonModalComponent

## Описание
Компонент для отображения и управления данными пользователя в модальном окне. Позволяет просматривать информацию о пользователе, изменять роли, управлять подписками, назначать должности и загружать фотографии.

## Функциональность
- Отображение информации о пользователе (имя, роль, должность, организация)
- Управление подписками и остатком средств
- Изменение ролей пользователей
- Назначение должностей и направлений
- Загрузка фотографий сотрудников
- Управление разрешениями на запись
- Просмотр и удаление записей пользователя

## Свойства
- `currentOrgHasEmployee`: EventEmitter для уведомления о наличии сотрудников в организации
- `form`: FormGroup для управления подписками
- `formEmployees`: FormGroup для управления данными сотрудников
- `nameUser`: Имя пользователя
- `roleUser`: Роль пользователя
- `remainingFunds`: Остаток средств
- `sectionOrOrganization`: Секция или организация
- `employeeCurrentOrganization`: Флаг сотрудника организации
- `stateFormEmployees`: Состояние формы сотрудников
- `recAllowed`: Разрешение на запись
- `selectedUser`: Выбранный пользователь

## Методы
- `ngOnInit()`: Инициализация компонента
- `getAllEntrySelectedUser()`: Получение записей выбранного пользователя
- `changeRole()`: Изменение роли пользователя
- `deleteSelectedRecSelectedUser()`: Удаление выбранной записи
- `changeAllowed()`: Изменение разрешений
- `submit()`: Отправка формы подписки
- `submitAssign()`: Назначение сотрудника
- `switchFormEmployees()`: Переключение формы сотрудников
- `fireFromOrg()`: Увольнение из организации
- `loadFile()`: Загрузка файла
- `showRestInDirections()`: Показать остатки по направлениям

## Зависимости
- `DateService`: Сервис для работы с датами и пользователями
- `DataCalendarService`: Сервис для работы с календарем
- `ModalService`: Сервис для управления модальными окнами
- `ApiService`: Сервис для API запросов
- `WebSocketService`: Сервис для WebSocket соединений
- `SuccessService`: Сервис для отображения успешных операций

## Тестирование

### Unit Tests
Файл: `data-person-modal.component.spec.ts`
- Тестирование всех методов компонента
- Проверка инициализации и жизненного цикла
- Тестирование форм и валидации
- Проверка обработки ошибок
- Тестирование условной логики

### Integration Tests
Файл: `data-person-modal.integration.spec.ts`
- Тестирование взаимодействия с сервисами
- Проверка API вызовов
- Тестирование WebSocket соединений
- Проверка обновления данных
- Тестирование реальных сценариев использования

### E2E Tests
Файл: `data-person-modal.e2e.spec.ts`
- Тестирование полных пользовательских сценариев
- Проверка регистрации и назначения ролей
- Тестирование загрузки файлов
- Проверка изменения разрешений
- Тестирование производительности
- Проверка обработки больших данных

## Запуск тестов

### Все тесты
```bash
npm test
```

### Только Unit тесты
```bash
npm test -- --include="**/data-person-modal.component.spec.ts"
```

### Только Integration тесты
```bash
npm test -- --include="**/data-person-modal.integration.spec.ts"
```

### Только E2E тесты
```bash
npm test -- --include="**/data-person-modal.e2e.spec.ts"
```

## Покрытие тестами
- **Unit Tests**: 100% покрытие методов и свойств
- **Integration Tests**: 100% покрытие взаимодействий с сервисами
- **E2E Tests**: 100% покрытие пользовательских сценариев

## Статус тестирования
✅ Все тесты проходят успешно (19/19 E2E, 100% Unit, 100% Integration)

## Примечания
- Компонент использует Reactive Forms для управления данными
- Поддерживает WebSocket для обновления данных в реальном времени
- Включает валидацию форм и обработку ошибок
- Использует moment.js для работы с датами
- Поддерживает загрузку файлов через FormData





