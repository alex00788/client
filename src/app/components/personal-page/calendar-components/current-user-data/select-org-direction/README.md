# SelectOrgDirectionComponent

## Описание
`SelectOrgDirectionComponent` - компонент для управления выбором направлений организации и сотрудников. Позволяет переключаться между просмотром направлений организации и списком сотрудников, а также выбирать конкретного сотрудника для детального просмотра.

## Основная функциональность
- Переключение между просмотром направлений и сотрудников
- Фильтрация и отображение списка сотрудников
- Выбор сотрудника для детального просмотра
- Возврат к просмотру организации
- Интеграция с сервисами для получения данных календаря

## Входные параметры
Компонент не принимает входные параметры через `@Input()`.

## Выходные параметры
- `clickedOnEmployee: EventEmitter<boolean>` - событие клика по сотруднику
- `dataAboutEmployee: EventEmitter<any>` - данные о выбранном сотруднике
- `idSelectedOrg: EventEmitter<any>` - ID выбранной организации

## Зависимости
### Сервисы
- `DateService` - управление датами и состоянием выбранной организации
- `DataCalendarService` - работа с календарными данными

### Angular модули
- `NgForOf` - для итерации по спискам
- `AsyncPipe` - для работы с асинхронными данными
- `NgIf` - для условного отображения
- `NgOptimizedImage` - для оптимизированной загрузки изображений

## Свойства компонента
- `btnCloseEmployee: boolean` - состояние кнопки закрытия сотрудника
- `disabledChoiceEmployee: boolean` - блокировка выбора сотрудника
- `btnHomeMenu: boolean` - состояние кнопки домашнего меню
- `employees: any` - список сотрудников
- `showEmployees: boolean` - флаг отображения сотрудников

## Основные методы

### `showEmployeesCurrentOrg()`
Подписывается на изменения в списке пользователей выбранной организации и обновляет список сотрудников.

### `getEmployeesList(employeeSelected: boolean, employeeId: string | null)`
Фильтрует и отображает сотрудников организации или одного конкретного сотрудника.
- При `employeeSelected = true` и указанном `employeeId` - показывает одного сотрудника
- При `employeeSelected = false` - показывает всех сотрудников с `jobTitle.length > 1`

### `switchDirection()`
Переключает отображение между направлениями организации и списком сотрудников.

### `choiceEmployee(employee: any)`
Выбирает сотрудника для детального просмотра. Выполняет:
- Блокировку повторного выбора
- Обновление состояния сервисов
- Эмит событий с данными сотрудника
- Загрузку календарных данных

### `returnToOrg()`
Возвращает к просмотру организации, сбрасывая состояние компонента.

### `returnToOrgAndCloseEmployees()`
Возвращает к просмотру организации и скрывает список сотрудников.

## Логика работы
1. При инициализации подписывается на изменения списка пользователей
2. Отображает направления организации или список сотрудников
3. При выборе сотрудника:
   - Блокирует интерфейс
   - Обновляет состояние в `DateService`
   - Загружает календарные данные через `DataCalendarService`
   - Эмитит события для родительских компонентов
4. При возврате к организации сбрасывает все состояния

## Тестирование
Компонент покрыт тремя типами тестов:

### Unit тесты (`select-org-direction.component.spec.ts`)
- **61 тест** покрывают все методы и сценарии
- Тестируют изолированную логику компонента
- Проверяют корректность работы с мок-сервисами
- Покрывают граничные случаи и обработку ошибок

### Интеграционные тесты (`select-org-direction.integration.spec.ts`)
- **13 тестов** проверяют взаимодействие с реальными сервисами
- Тестируют синхронизацию данных между сервисами
- Проверяют жизненный цикл компонента
- Покрывают обработку ошибок сервисов

### E2E тесты (`select-org-direction.e2e.spec.ts`)
- **13 тестов** проверяют полные пользовательские сценарии
- Тестируют производительность и управление памятью
- Проверяют доступность и UX
- Покрывают сложные многошаговые сценарии

## Использование
```typescript
<app-select-org-direction
  (clickedOnEmployee)="onEmployeeClick($event)"
  (dataAboutEmployee)="onEmployeeData($event)"
  (idSelectedOrg)="onOrgSelected($event)">
</app-select-org-direction>
```

## Стили
Компонент использует CSS файл `select-org-direction.component.css` для стилизации:
- `.directionTitleWrapper` - обертка для заголовка направления
- Адаптивный дизайн для различных размеров экрана
- Стили для кнопок и элементов интерфейса

## Зависимости Angular
- Angular Core
- RxJS (Subject, takeUntil, BehaviorSubject)
- Angular Common (NgForOf, AsyncPipe, NgIf, NgOptimizedImage)

## Архитектурные особенности
- Standalone компонент (не требует NgModule)
- Использует реактивное программирование с RxJS
- Правильное управление подписками с `takeUntil`
- Разделение ответственности между сервисами