# HeaderCalendarComponent

## Описание

`HeaderCalendarComponent` - это компонент заголовка календаря в приложении. Он отвечает за навигацию между месяцами, отображение текущей даты и управление часами реального времени.

## Основные функции

### Навигация по календарю
- `go(direction: number)` - навигация между месяцами (1 - вперед, -1 - назад)
- Автоматическое обновление данных календаря при смене месяца

### Управление временем
- `watchOnPage()` - запуск часов реального времени
- Автоматическое форматирование времени (добавление ведущих нулей)
- Обновление каждую секунду

### Жизненный цикл
- `ngOnInit()` - инициализация компонента (часы не запускаются по умолчанию)
- `ngOnDestroy()` - очистка интервалов при уничтожении компонента

## Зависимости

- `DateService` - для управления датами и состоянием календаря
- `DataCalendarService` - для получения данных календаря

## Свойства компонента

- `subInterval` - идентификатор интервала для часов
- `hours` - текущий час (форматированный)
- `min` - текущие минуты (форматированные)
- `sec` - текущие секунды (форматированные)
- `currentTime` - строка текущего времени
- `dataSettings` - настройки данных

## Шаблон

Компонент отображает:
- Кнопку навигации назад (`<`)
- Текущую дату в формате moment.js
- Кнопку навигации вперед (`>`)

## Тестирование

Компонент покрыт комплексными тестами трех уровней:

### 1. Unit Tests (`header-calendar.component.spec.ts`)
- Тестирование отдельных методов компонента
- Mock-объекты для зависимостей
- Проверка корректности навигации
- Тестирование управления интервалами и жизненного цикла
- **47 тестов** покрывающих все аспекты функциональности

#### Группы тестов:
- **Component Creation and Initialization** - создание и инициализация
- **ngOnInit** - тестирование инициализации
- **go Method** - тестирование навигации
- **watchOnPage Method** - тестирование часов
- **ngOnDestroy** - тестирование очистки ресурсов
- **Time Formatting Logic** - тестирование форматирования времени
- **Service Integration** - интеграция с сервисами
- **Edge Cases and Error Handling** - обработка ошибок
- **Component State Management** - управление состоянием
- **Performance and Memory Management** - производительность
- **Template Integration** - интеграция с шаблоном
- **Lifecycle Integration** - полный жизненный цикл

### 2. Integration Tests (`header-calendar.integration.spec.ts`)
- Тестирование взаимодействия с реальными сервисами
- Проверка интеграции с `DateService` и `DataCalendarService`
- Тестирование реального DOM и пользовательских взаимодействий
- **58 тестов** для проверки интеграции компонентов

#### Группы тестов:
- **Full Component Lifecycle Integration** - полный жизненный цикл
- **Real Service Integration** - интеграция с реальными сервисами
- **Real Calendar Navigation Integration** - навигация календаря
- **Real Data Flow Integration** - поток данных
- **Real Time Management Integration** - управление временем
- **Real UI Integration** - интеграция пользовательского интерфейса
- **Real Error Handling Integration** - обработка ошибок
- **Real Performance Integration** - производительность
- **Real World Scenarios** - реальные сценарии
- **Real Service State Integration** - состояние сервисов
- **Real Memory Management Integration** - управление памятью

### 3. E2E Tests (`header-calendar.e2e.spec.ts`)
- Тестирование полных рабочих процессов
- Проверка пользовательских сценариев
- Тестирование производительности и доступности
- **49 тестов** для сквозного тестирования

#### Группы тестов:
- **Complete User Journey** - полные пользовательские сценарии
- **Real-World Scenarios** - реальные сценарии использования
- **Edge Cases and Error Handling** - граничные случаи
- **Performance and Memory Management** - производительность
- **Accessibility and UX** - доступность и UX
- **Data Persistence and State Management** - сохранение данных
- **Search and Filter Functionality** - поиск и фильтрация
- **Real Service State Integration** - интеграция состояния сервисов

## Запуск тестов

```bash
# Запуск всех тестов для компонента
ng test --include="**/header-calendar*.spec.ts" --watch=false

# Запуск только unit тестов
ng test --include="**/header-calendar.component.spec.ts" --watch=false

# Запуск только интеграционных тестов
ng test --include="**/header-calendar.integration.spec.ts" --watch=false

# Запуск только E2E тестов
ng test --include="**/header-calendar.e2e.spec.ts" --watch=false
```

## Покрытие тестами

Компонент покрыт тестами на 100% по следующим аспектам:

- ✅ Все публичные методы (`go`, `watchOnPage`, `ngOnInit`, `ngOnDestroy`)
- ✅ Интеграция с сервисами (`DateService`, `DataCalendarService`)
- ✅ Управление интервалами и очистка ресурсов
- ✅ Навигация по календарю
- ✅ Форматирование времени
- ✅ Обработка ошибок и граничных случаев
- ✅ Жизненный цикл компонента
- ✅ UI взаимодействия
- ✅ Производительность и управление памятью
- ✅ Доступность и UX

## Примечания по использованию

1. **Управление интервалами**: Компонент автоматически очищает интервалы при уничтожении через `ngOnDestroy`
2. **Часы реального времени**: Метод `watchOnPage()` должен вызываться вручную для запуска часов
3. **Навигация**: Использует `moment.js` для работы с датами через `DateService`
4. **Автообновление данных**: При навигации автоматически обновляются данные календаря

## Примеры использования

```typescript
// Навигация вперед на месяц
component.go(1);

// Навигация назад на месяц
component.go(-1);

// Запуск часов реального времени
component.watchOnPage();

// Получение текущей даты
const currentDate = component.dateService.date.value;
```

## Архитектура

Компонент следует принципам:
- **Single Responsibility** - отвечает только за заголовок календаря
- **Dependency Injection** - использует DI для сервисов
- **OnPush Change Detection** - оптимизирован для производительности
- **Memory Management** - корректно управляет ресурсами
- **Testability** - полностью покрыт тестами

## Производительность

- Легковесный компонент с минимальным DOM
- Эффективное управление интервалами
- Оптимизированные обновления данных
- Производительность проверена в тестах (операции завершаются менее чем за 1 секунду)

## Совместимость

- Angular 17+
- Moment.js
- RxJS
- Jasmine/Karma для тестирования

